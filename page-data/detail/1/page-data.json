{"componentChunkName":"component---src-templates-detail-js","path":"/detail/1","result":{"data":{"markdownRemark":{"html":"<h4 id=\"1-安装-codepush-cli\" style=\"position:relative;\"><a href=\"#1-%E5%AE%89%E8%A3%85-codepush-cli\" aria-label=\"1 安装 codepush cli permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 安装 CodePush CLI</h4>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">npm install -g code-push-cli</code>\n        </deckgo-highlight-code>\n      \n<h4 id=\"2-注册-codepush-账号\" style=\"position:relative;\"><a href=\"#2-%E6%B3%A8%E5%86%8C-codepush-%E8%B4%A6%E5%8F%B7\" aria-label=\"2 注册 codepush 账号 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 注册 CodePush 账号</h4>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">code-push register</code>\n        </deckgo-highlight-code>\n      \n<blockquote>\n<p>⚠️ 这里会弹出一个网页选择 <code>github</code> 授权， 注册成功后会得到一个 <code>key</code> , 将 <code>key</code> 复制到终端回车</p>\n</blockquote>\n<h4 id=\"3-添加-ios-平台应用\" style=\"position:relative;\"><a href=\"#3-%E6%B7%BB%E5%8A%A0-ios-%E5%B9%B3%E5%8F%B0%E5%BA%94%E7%94%A8\" aria-label=\"3 添加 ios 平台应用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 添加 ios 平台应用</h4>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">code-push app add rebooking-ios ios react-native</code>\n        </deckgo-highlight-code>\n      \n<p>得到下面的两个 <code>key</code> ， 后面会用到\n<img src=\"https://user-gold-cdn.xitu.io/2020/4/25/171b117a8ab2e189?w=996&#x26;h=206&#x26;f=png&#x26;s=130592\" alt=\"屏幕快照 2019-04-24 上午10.09.27.png\"></p>\n<h4 id=\"4-添加-android-平台应用\" style=\"position:relative;\"><a href=\"#4-%E6%B7%BB%E5%8A%A0-android-%E5%B9%B3%E5%8F%B0%E5%BA%94%E7%94%A8\" aria-label=\"4 添加 android 平台应用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 添加 android 平台应用</h4>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">code-push app add rebooking-android android react-native</code>\n        </deckgo-highlight-code>\n      \n<p>得到的东西和 ios 一样</p>\n<p>进入 <a href=\"https://appcenter.ms/\">https://appcenter.ms/</a> 可以看到你刚才创建的app， 如下图\n<img src=\"https://user-gold-cdn.xitu.io/2020/4/25/171b117a8a9833cd?w=1240&#x26;h=342&#x26;f=png&#x26;s=49055\" alt=\"屏幕快照 2019-04-24 上午10.15.11.png\"></p>\n<hr>\n<h5 id=\"下面开始整合到-react-native\" style=\"position:relative;\"><a href=\"#%E4%B8%8B%E9%9D%A2%E5%BC%80%E5%A7%8B%E6%95%B4%E5%90%88%E5%88%B0-react-native\" aria-label=\"下面开始整合到 react native permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>下面开始整合到 react-native</h5>\n<h4 id=\"5-react-native-中安装-code-push-组件\" style=\"position:relative;\"><a href=\"#5-react-native-%E4%B8%AD%E5%AE%89%E8%A3%85-code-push-%E7%BB%84%E4%BB%B6\" aria-label=\"5 react native 中安装 code push 组件 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. react-native 中安装 code-push 组件</h4>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">npm install react-native-code-push --save</code>\n        </deckgo-highlight-code>\n      \n<h4 id=\"6-添加原生依赖，-使用-link-到-android-和-ios-中\" style=\"position:relative;\"><a href=\"#6-%E6%B7%BB%E5%8A%A0%E5%8E%9F%E7%94%9F%E4%BE%9D%E8%B5%96%EF%BC%8C-%E4%BD%BF%E7%94%A8-link-%E5%88%B0-android-%E5%92%8C-ios-%E4%B8%AD\" aria-label=\"6 添加原生依赖， 使用 link 到 android 和 ios 中 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. 添加原生依赖， 使用 link 到 android 和 ios 中</h4>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">react-native link react-native-code-push</code>\n        </deckgo-highlight-code>\n      \n<blockquote>\n<p>如果 <code>link</code> 的时候出现 <code>rnpm-install ERR! ERRPACKAGEJSON No package found. Are you sure this i a React Native project? Package name not found in ...</code>等， 请使用新版本的<code>react-native</code> 版本<code>react-native init MyApp --version 0.59.5</code> 我这里使用 59</p>\n</blockquote>\n<p>运行react-native link的时候，命令行会提示输入部署码<code>What is your CodePush deployment key for Android (hit &#x3C;ENTER> to ignore)</code>\n这个时候将你<code>Android</code> 中 <code>Production</code> 的 <code>Deployment Key</code> 粘贴回程。 <code>ios</code> 同理。</p>\n<h4 id=\"7-将-android-和-ios-的版本号改为-100\" style=\"position:relative;\"><a href=\"#7-%E5%B0%86-android-%E5%92%8C-ios-%E7%9A%84%E7%89%88%E6%9C%AC%E5%8F%B7%E6%94%B9%E4%B8%BA-100\" aria-label=\"7 将 android 和 ios 的版本号改为 100 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>7. 将 Android 和 ios 的版本号改为 1.0.0</h4>\n<p><img src=\"https://user-gold-cdn.xitu.io/2020/4/25/171b117a8db7c7be?w=941&#x26;h=306&#x26;f=png&#x26;s=68350\" alt=\"Android 版本号修改.png\">\n<img src=\"https://user-gold-cdn.xitu.io/2020/4/25/171b117a8b7d22ba?w=968&#x26;h=199&#x26;f=png&#x26;s=91188\" alt=\"IOS 版本号修改.png.png\"></p>\n<h4 id=\"8-在-react-native-项目中的首页中-使用-code-push\" style=\"position:relative;\"><a href=\"#8-%E5%9C%A8-react-native-%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E9%A6%96%E9%A1%B5%E4%B8%AD-%E4%BD%BF%E7%94%A8-code-push\" aria-label=\"8 在 react native 项目中的首页中 使用 code push permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8. 在 react-native 项目中的首页中 使用 code-push</h4>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">/**\n * Sample React Native App\n * https://github.com/facebook/react-native\n *\n * @format\n * @flow\n */\n\nimport React, {Component} from &#39;react&#39;;\nimport {Platform, StyleSheet, Text, View} from &#39;react-native&#39;;\nimport CodePush from &quot;react-native-code-push&quot;;\nconst instructions = Platform.select({\n  ios: &#39;Press Cmd+R to reload,\\n&#39; + &#39;Cmd+D or shake for dev menu&#39;,\n  android:\n    &#39;Double tap R on your keyboard to reload,\\n&#39; +\n    &#39;Shake or press menu button for dev menu&#39;,\n});\n\nexport default class App extends Component {\n\n  componentDidMount(){\n    CodePush.sync({\n      //安装模式\n      //ON_NEXT_RESUME 下次恢复到前台时\n      //ON_NEXT_RESTART 下一次重启时\n      //IMMEDIATE 马上更新\n      installMode : CodePush.InstallMode.IMMEDIATE ,\n      //对话框\n      updateDialog : {\n          //是否显示更新描述\n          appendReleaseDescription : true ,\n          //更新描述的前缀。 默认为&quot;Description&quot;\n          descriptionPrefix : &quot;更新内容：&quot; ,\n          //强制更新按钮文字，默认为continue\n          mandatoryContinueButtonLabel : &quot;立即更新&quot; ,\n          //强制更新时的信息. 默认为&quot;An update is available that must be installed.&quot;\n          mandatoryUpdateMessage : &quot;必须更新后才能使用&quot; ,\n          //非强制更新时，按钮文字,默认为&quot;ignore&quot;\n          optionalIgnoreButtonLabel : &#39;稍后&#39; ,\n          //非强制更新时，确认按钮文字. 默认为&quot;Install&quot;\n          optionalInstallButtonLabel : &#39;后台更新&#39; ,\n          //非强制更新时，检查到更新的消息文本\n          optionalUpdateMessage : &#39;有新版本了，是否更新？&#39; ,\n          //Alert窗口的标题\n          title : &#39;更新提示&#39;\n        }\n      }\n    );\n  }\n\n  render() {\n    return (\n      &lt;View style={styles.container}&gt;\n        &lt;Text style={styles.welcome}&gt;Welcome to React Native!&lt;/Text&gt;\n        &lt;Text style={styles.instructions}&gt;To get started, edit App.js&lt;/Text&gt;\n        &lt;Text style={styles.instructions}&gt;{instructions}&lt;/Text&gt;\n      &lt;/View&gt;\n    );\n  }\n}</code>\n        </deckgo-highlight-code>\n      \n<h4 id=\"9-发布更新\" style=\"position:relative;\"><a href=\"#9-%E5%8F%91%E5%B8%83%E6%9B%B4%E6%96%B0\" aria-label=\"9 发布更新 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>9. 发布更新</h4>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">code-push release-react rebooking-ios ios -d Production\ncode-push release-react rebooking-android android -d Production</code>\n        </deckgo-highlight-code>\n      \n<p>最后打开手机查看效果\n<img src=\"https://user-gold-cdn.xitu.io/2020/4/25/171b117a8f46caf2?w=1240&#x26;h=403&#x26;f=png&#x26;s=88610\" alt=\"屏幕快照 2019-04-24 上午10.42.10.png\"></p>\n<blockquote>\n<p>关于自定义更新弹框 ，参照下面的文章</p>\n</blockquote>\n<p><img src=\"https://user-gold-cdn.xitu.io/2020/4/25/171b117a8da8f1b4?w=930&#x26;h=1458&#x26;f=png&#x26;s=191751\" alt=\"image.png\"></p>","timeToRead":4,"tableOfContents":"<ul>\n<li><a href=\"/myblog/detail/1/#1-%E5%AE%89%E8%A3%85-codepush-cli\">1. 安装 CodePush CLI</a></li>\n<li><a href=\"/myblog/detail/1/#2-%E6%B3%A8%E5%86%8C-codepush-%E8%B4%A6%E5%8F%B7\">2. 注册 CodePush 账号</a></li>\n<li><a href=\"/myblog/detail/1/#3-%E6%B7%BB%E5%8A%A0-ios-%E5%B9%B3%E5%8F%B0%E5%BA%94%E7%94%A8\">3. 添加 ios 平台应用</a></li>\n<li>\n<p><a href=\"/myblog/detail/1/#4-%E6%B7%BB%E5%8A%A0-android-%E5%B9%B3%E5%8F%B0%E5%BA%94%E7%94%A8\">4. 添加 android 平台应用</a></p>\n<ul>\n<li><a href=\"/myblog/detail/1/#%E4%B8%8B%E9%9D%A2%E5%BC%80%E5%A7%8B%E6%95%B4%E5%90%88%E5%88%B0-react-native\">下面开始整合到 react-native</a></li>\n</ul>\n</li>\n<li><a href=\"/myblog/detail/1/#5-react-native-%E4%B8%AD%E5%AE%89%E8%A3%85-code-push-%E7%BB%84%E4%BB%B6\">5. react-native 中安装 code-push 组件</a></li>\n<li><a href=\"/myblog/detail/1/#6-%E6%B7%BB%E5%8A%A0%E5%8E%9F%E7%94%9F%E4%BE%9D%E8%B5%96%EF%BC%8C-%E4%BD%BF%E7%94%A8-link-%E5%88%B0-android-%E5%92%8C-ios-%E4%B8%AD\">6. 添加原生依赖， 使用 link 到 android 和 ios 中</a></li>\n<li><a href=\"/myblog/detail/1/#7-%E5%B0%86-android-%E5%92%8C-ios-%E7%9A%84%E7%89%88%E6%9C%AC%E5%8F%B7%E6%94%B9%E4%B8%BA-100\">7. 将 Android 和 ios 的版本号改为 1.0.0</a></li>\n<li><a href=\"/myblog/detail/1/#8-%E5%9C%A8-react-native-%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E9%A6%96%E9%A1%B5%E4%B8%AD-%E4%BD%BF%E7%94%A8-code-push\">8. 在 react-native 项目中的首页中 使用 code-push</a></li>\n<li><a href=\"/myblog/detail/1/#9-%E5%8F%91%E5%B8%83%E6%9B%B4%E6%96%B0\">9. 发布更新</a></li>\n</ul>","frontmatter":{"date":"2019-04-26","path":"/detail/1","title":"react-native code-push 热更新","img":"https://pic4.zhimg.com/80/ed93cb4a546971f4dfaaf31666dfb8b1_1440w.jpg"}}},"pageContext":{}}}